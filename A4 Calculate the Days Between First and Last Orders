Calculate the Days Between First and Last Orders


SELECT DISTINCT CustomerID, 
   DATEDIFF(DAY,FIRST_VALUE(OrderDate) OVER(PARTITION BY CustomerID ORDER BY OrderID
   ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW),
   LAST_VALUE(OrderDate) OVER(PARTITION BY CustomerID ORDER BY OrderID 
   ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)) AS OrderSpanDays
FROM Sales;
